---
title: Config Theme
description: Adds and sets Suckless Windows theme
privilege: TrustedInstaller
actions:
  - !writeStatus: {status: "Theming", option: "configure-theme"}
    # Copy files
  - !cmd:
    command: 'robocopy "Wallpapers" "C:\SucklessWindows\Wallpapers" /E /IM /IT /NP > nul'
    exeDir: true
    wait: true

    # Set background
  - !registryValue:
    path: 'HKCU\Control Panel\Desktop'
    value: 'TranscodedImageCache'
    operation: delete
    option: "configure-theme"

  - !registryValue:
    path: 'HKCU\Control Panel\Desktop'
    value: 'WallPaper'
    data: '%SystemDrive%\SucklessWindows\Wallpapers\img.png'
    type: REG_SZ
    option: "configure-theme"

  - !registryValue:
    path: 'HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Wallpapers'
    value: 'BackgroundHistoryPath0'
    data: '%SystemDrive%\SucklessWindows\Wallpapers\img.png'
    type: REG_SZ
    option: "configure-theme"

  - !registryValue:
    path: 'HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Wallpapers'
    value: 'BackgroundType'
    data: '0'
    type: REG_DWORD
    option: "configure-theme"

  - !registryValue:
    path: 'HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Wallpapers'
    value: 'WallpaperStyle'
    data: '10'
    type: REG_SZ
    option: "configure-theme"

    # Change Profile picture
  - !powerShell:
    command: '.\pfp.ps1'
    exeDir: true
    runas: currentUserElevated
    option: "configure-theme"

    # Do some tasks
  - !run:
    exeDir: true
    exe: "theme.cmd"
    weight: 90
    option: "configure-theme"
  - !run:
    {exe: 'rundll32.exe', args: 'user32.dll,UpdatePerUserSystemParameters', option: "configure-theme"}

    # Disable Animations and Effects
  - !registryValue:
    path: 'HKCU\Control Panel\Desktop\WindowMetrics'
    value: 'MinAnimate'
    data: '0'
    type: REG_SZ
    option: "disable-effects"

  - !registryValue:
    path: 'HKCU\Software\Microsoft\Windows\CurrentVersion\Themes\Personalize'
    value: 'EnableTransparency'
    data: '0'
    type: REG_SZ
    option: "disable-effects"