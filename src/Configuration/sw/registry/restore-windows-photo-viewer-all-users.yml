---
title: restore-windows-photo-viewer-all-users
description: restore-windows-photo-viewer-all-users
privilege: TrustedInstaller
actions:

    # Created by: Shawn Brink
    # Created on: August 8th 2015
    # Updated on: August 5th 2018
    # Tutorial: https://www.tenforums.com/tutorials/14312-restore-windows-photo-viewer-windows-10-a.html
  - !registryValue: {path: 'HKCR\Applications\photoviewer.dll\shell\open', value: 'MuiVerb', type: REG_SZ, data: '@photoviewer.dll,-3043', option: "configure-lpv"}
  - !registryValue: {path: 'HKCR\Applications\photoviewer.dll\shell\open\command', value: '', type: REG_EXPAND_SZ, data: '%SystemRoot%\System32\rundll32.exe "%ProgramFiles%\Windows Photo Viewer\PhotoViewer.dll", ImageView_Fullscreen %1', option: "configure-lpv"}
  - !registryValue: {path: 'HKCR\Applications\photoviewer.dll\shell\open\DropTarget', value: 'Clsid', type: REG_SZ, data: '{FFE2A43C-56B9-4bf5-9A79-CC6D4285608A}', option: "configure-lpv"}
  - !registryValue: {path: 'HKCR\PhotoViewer.FileAssoc.Bitmap', value: 'ImageOptionFlags', type: REG_DWORD, data: '1', option: "configure-lpv"}
  - !registryValue: {path: 'HKCR\PhotoViewer.FileAssoc.Bitmap', value: 'FriendlyTypeName', type: REG_EXPAND_SZ, data: '@%ProgramFiles%\Windows Photo Viewer\PhotoViewer.dll,-3056', option: "configure-lpv"}
  - !registryValue: {path: 'HKCR\PhotoViewer.FileAssoc.Bitmap\DefaultIcon', value: '', type: REG_SZ, data: '%SystemRoot%\System32\imageres.dll,-70', option: "configure-lpv"}
  - !registryValue: {path: 'HKCR\PhotoViewer.FileAssoc.Bitmap\shell\open\command', value: '', type: REG_EXPAND_SZ, data: '%SystemRoot%\System32\rundll32.exe "%ProgramFiles%\Windows Photo Viewer\PhotoViewer.dll", ImageView_Fullscreen %1', option: "configure-lpv"}
  - !registryValue: {path: 'HKCR\PhotoViewer.FileAssoc.Bitmap\shell\open\DropTarget', value: 'Clsid', type: REG_SZ, data: '{FFE2A43C-56B9-4bf5-9A79-CC6D4285608A}', option: "configure-lpv"}
  - !registryValue: {path: 'HKCR\Applications\photoviewer.dll\shell\print', value: 'NeverDefault', type: REG_SZ, data: '', option: "configure-lpv"}
  - !registryValue: {path: 'HKCR\Applications\photoviewer.dll\shell\print\command', value: '', type: REG_EXPAND_SZ, data: '%SystemRoot%\System32\rundll32.exe "%ProgramFiles%\Windows Photo Viewer\PhotoViewer.dll", ImageView_Fullscreen %1', option: "configure-lpv"}
  - !registryValue: {path: 'HKCR\Applications\photoviewer.dll\shell\print\DropTarget', value: 'Clsid', type: REG_SZ, data: '{60fd46de-f830-4894-a628-6fa81bc0190d}', option: "configure-lpv"}
  - !registryValue: {path: 'HKCR\PhotoViewer.FileAssoc.JFIF', value: 'EditFlags', type: REG_DWORD, data: '65536', option: "configure-lpv"}
  - !registryValue: {path: 'HKCR\PhotoViewer.FileAssoc.JFIF', value: 'ImageOptionFlags', type: REG_DWORD, data: '1', option: "configure-lpv"}
  - !registryValue: {path: 'HKCR\PhotoViewer.FileAssoc.JFIF', value: 'FriendlyTypeName', type: REG_EXPAND_SZ, data: '@%ProgramFiles%\Windows Photo Viewer\PhotoViewer.dll,-3055', option: "configure-lpv"}
  - !registryValue: {path: 'HKCR\PhotoViewer.FileAssoc.JFIF\DefaultIcon', value: '', type: REG_SZ, data: '%SystemRoot%\System32\imageres.dll,-72', option: "configure-lpv"}
  - !registryValue: {path: 'HKCR\PhotoViewer.FileAssoc.JFIF\shell\open', value: 'MuiVerb', type: REG_EXPAND_SZ, data: '@%ProgramFiles%\Windows Photo Viewer\photoviewer.dll,-3043', option: "configure-lpv"}
  - !registryValue: {path: 'HKCR\PhotoViewer.FileAssoc.JFIF\shell\open\command', value: '', type: REG_EXPAND_SZ, data: '%SystemRoot%\System32\rundll32.exe "%ProgramFiles%\Windows Photo Viewer\PhotoViewer.dll", ImageView_Fullscreen %1', option: "configure-lpv"}
  - !registryValue: {path: 'HKCR\PhotoViewer.FileAssoc.JFIF\shell\open\DropTarget', value: 'Clsid', type: REG_SZ, data: '{FFE2A43C-56B9-4bf5-9A79-CC6D4285608A}', option: "configure-lpv"}
  - !registryValue: {path: 'HKCR\PhotoViewer.FileAssoc.Jpeg', value: 'EditFlags', type: REG_DWORD, data: '65536', option: "configure-lpv"}
  - !registryValue: {path: 'HKCR\PhotoViewer.FileAssoc.Jpeg', value: 'ImageOptionFlags', type: REG_DWORD, data: '1', option: "configure-lpv"}
  - !registryValue: {path: 'HKCR\PhotoViewer.FileAssoc.Jpeg', value: 'FriendlyTypeName', type: REG_EXPAND_SZ, data: '@%ProgramFiles%\Windows Photo Viewer\PhotoViewer.dll,-3055', option: "configure-lpv"}
  - !registryValue: {path: 'HKCR\PhotoViewer.FileAssoc.Jpeg\DefaultIcon', value: '', type: REG_SZ, data: '%SystemRoot%\System32\imageres.dll,-72', option: "configure-lpv"}
  - !registryValue: {path: 'HKCR\PhotoViewer.FileAssoc.Jpeg\shell\open', value: 'MuiVerb', type: REG_EXPAND_SZ, data: '@%ProgramFiles%\Windows Photo Viewer\photoviewer.dll,-3043', option: "configure-lpv"}
  - !registryValue: {path: 'HKCR\PhotoViewer.FileAssoc.Jpeg\shell\open\command', value: '', type: REG_EXPAND_SZ, data: '%SystemRoot%\System32\rundll32.exe "%ProgramFiles%\Windows Photo Viewer\PhotoViewer.dll", ImageView_Fullscreen %1', option: "configure-lpv"}
  - !registryValue: {path: 'HKCR\PhotoViewer.FileAssoc.Jpeg\shell\open\DropTarget', value: 'Clsid', type: REG_SZ, data: '{FFE2A43C-56B9-4bf5-9A79-CC6D4285608A}', option: "configure-lpv"}
  - !registryValue: {path: 'HKCR\PhotoViewer.FileAssoc.Gif', value: 'ImageOptionFlags', type: REG_DWORD, data: '1', option: "configure-lpv"}
  - !registryValue: {path: 'HKCR\PhotoViewer.FileAssoc.Gif', value: 'FriendlyTypeName', type: REG_EXPAND_SZ, data: '@%ProgramFiles%\Windows Photo Viewer\PhotoViewer.dll,-3057', option: "configure-lpv"}
  - !registryValue: {path: 'HKCR\PhotoViewer.FileAssoc.Gif\DefaultIcon', value: '', type: REG_SZ, data: '%SystemRoot%\System32\imageres.dll,-83', option: "configure-lpv"}
  - !registryValue: {path: 'HKCR\PhotoViewer.FileAssoc.Gif\shell\open\command', value: '', type: REG_EXPAND_SZ, data: '%SystemRoot%\System32\rundll32.exe "%ProgramFiles%\Windows Photo Viewer\PhotoViewer.dll", ImageView_Fullscreen %1', option: "configure-lpv"}
  - !registryValue: {path: 'HKCR\PhotoViewer.FileAssoc.Gif\shell\open\DropTarget', value: 'Clsid', type: REG_SZ, data: '{FFE2A43C-56B9-4bf5-9A79-CC6D4285608A}', option: "configure-lpv"}
  - !registryValue: {path: 'HKCR\PhotoViewer.FileAssoc.Png', value: 'ImageOptionFlags', type: REG_DWORD, data: '1', option: "configure-lpv"}
  - !registryValue: {path: 'HKCR\PhotoViewer.FileAssoc.Png', value: 'FriendlyTypeName', type: REG_EXPAND_SZ, data: '@%ProgramFiles%\Windows Photo Viewer\PhotoViewer.dll,-3057', option: "configure-lpv"}
  - !registryValue: {path: 'HKCR\PhotoViewer.FileAssoc.Png\DefaultIcon', value: '', type: REG_SZ, data: '%SystemRoot%\System32\imageres.dll,-71', option: "configure-lpv"}
  - !registryValue: {path: 'HKCR\PhotoViewer.FileAssoc.Png\shell\open\command', value: '', type: REG_EXPAND_SZ, data: '%SystemRoot%\System32\rundll32.exe "%ProgramFiles%\Windows Photo Viewer\PhotoViewer.dll", ImageView_Fullscreen %1', option: "configure-lpv"}
  - !registryValue: {path: 'HKCR\PhotoViewer.FileAssoc.Png\shell\open\DropTarget', value: 'Clsid', type: REG_SZ, data: '{FFE2A43C-56B9-4bf5-9A79-CC6D4285608A}', option: "configure-lpv"}
  - !registryValue: {path: 'HKCR\PhotoViewer.FileAssoc.Wdp', value: 'EditFlags', type: REG_DWORD, data: '65536', option: "configure-lpv"}
  - !registryValue: {path: 'HKCR\PhotoViewer.FileAssoc.Wdp', value: 'ImageOptionFlags', type: REG_DWORD, data: '1', option: "configure-lpv"}
  - !registryValue: {path: 'HKCR\PhotoViewer.FileAssoc.Wdp\DefaultIcon', value: '', type: REG_SZ, data: '%SystemRoot%\System32\wmphoto.dll,-400', option: "configure-lpv"}
  - !registryValue: {path: 'HKCR\PhotoViewer.FileAssoc.Wdp\shell\open', value: 'MuiVerb', type: REG_EXPAND_SZ, data: '@%ProgramFiles%\Windows Photo Viewer\photoviewer.dll,-3043', option: "configure-lpv"}
  - !registryValue: {path: 'HKCR\PhotoViewer.FileAssoc.Wdp\shell\open\command', value: '', type: REG_EXPAND_SZ, data: '%SystemRoot%\System32\rundll32.exe "%ProgramFiles%\Windows Photo Viewer\PhotoViewer.dll", ImageView_Fullscreen %1', option: "configure-lpv"}
  - !registryValue: {path: 'HKCR\PhotoViewer.FileAssoc.Wdp\shell\open\DropTarget', value: 'Clsid', type: REG_SZ, data: '{FFE2A43C-56B9-4bf5-9A79-CC6D4285608A}', option: "configure-lpv"}
  - !registryValue: {path: 'HKCR\SystemFileAssociations\image\shell\Image Preview\command', value: '', type: REG_EXPAND_SZ, data: '%SystemRoot%\System32\rundll32.exe "%ProgramFiles%\Windows Photo Viewer\PhotoViewer.dll", ImageView_Fullscreen %1', option: "configure-lpv"}
  - !registryValue: {path: 'HKCR\SystemFileAssociations\image\shell\Image Preview\DropTarget', value: '{FFE2A43C-56B9-4bf5-9A79-CC6D4285608A}', type: REG_SZ, data: '', option: "configure-lpv"}
  - !registryValue: {path: 'HKLM\SOFTWARE\Microsoft\Windows Photo Viewer\Capabilities', value: 'ApplicationDescription', type: REG_SZ, data: '@%ProgramFiles%\Windows Photo Viewer\photoviewer.dll,-3069', option: "configure-lpv"}
  - !registryValue: {path: 'HKLM\SOFTWARE\Microsoft\Windows Photo Viewer\Capabilities', value: 'ApplicationName', type: REG_SZ, data: '@%ProgramFiles%\Windows Photo Viewer\photoviewer.dll,-3009', option: "configure-lpv"}
  - !registryValue: {path: 'HKLM\SOFTWARE\Microsoft\Windows Photo Viewer\Capabilities\FileAssociations', value: '.cr2', type: REG_SZ, data: 'PhotoViewer.FileAssoc.Tiff', option: "configure-lpv"}
  - !registryValue: {path: 'HKLM\SOFTWARE\Microsoft\Windows Photo Viewer\Capabilities\FileAssociations', value: '.jpg', type: REG_SZ, data: 'PhotoViewer.FileAssoc.Jpeg', option: "configure-lpv"}
  - !registryValue: {path: 'HKLM\SOFTWARE\Microsoft\Windows Photo Viewer\Capabilities\FileAssociations', value: '.wdp', type: REG_SZ, data: 'PhotoViewer.FileAssoc.Wdp', option: "configure-lpv"}
  - !registryValue: {path: 'HKLM\SOFTWARE\Microsoft\Windows Photo Viewer\Capabilities\FileAssociations', value: '.jfif', type: REG_SZ, data: 'PhotoViewer.FileAssoc.JFIF', option: "configure-lpv"}
  - !registryValue: {path: 'HKLM\SOFTWARE\Microsoft\Windows Photo Viewer\Capabilities\FileAssociations', value: '.dib', type: REG_SZ, data: 'PhotoViewer.FileAssoc.Bitmap', option: "configure-lpv"}
  - !registryValue: {path: 'HKLM\SOFTWARE\Microsoft\Windows Photo Viewer\Capabilities\FileAssociations', value: '.png', type: REG_SZ, data: 'PhotoViewer.FileAssoc.Png', option: "configure-lpv"}
  - !registryValue: {path: 'HKLM\SOFTWARE\Microsoft\Windows Photo Viewer\Capabilities\FileAssociations', value: '.jxr', type: REG_SZ, data: 'PhotoViewer.FileAssoc.Wdp', option: "configure-lpv"}
  - !registryValue: {path: 'HKLM\SOFTWARE\Microsoft\Windows Photo Viewer\Capabilities\FileAssociations', value: '.bmp', type: REG_SZ, data: 'PhotoViewer.FileAssoc.Bitmap', option: "configure-lpv"}
  - !registryValue: {path: 'HKLM\SOFTWARE\Microsoft\Windows Photo Viewer\Capabilities\FileAssociations', value: '.jpe', type: REG_SZ, data: 'PhotoViewer.FileAssoc.Jpeg', option: "configure-lpv"}
  - !registryValue: {path: 'HKLM\SOFTWARE\Microsoft\Windows Photo Viewer\Capabilities\FileAssociations', value: '.jpeg', type: REG_SZ, data: 'PhotoViewer.FileAssoc.Jpeg', option: "configure-lpv"}
  - !registryValue: {path: 'HKLM\SOFTWARE\Microsoft\Windows Photo Viewer\Capabilities\FileAssociations', value: '.gif', type: REG_SZ, data: 'PhotoViewer.FileAssoc.Gif', option: "configure-lpv"}
  - !registryValue: {path: 'HKLM\SOFTWARE\Microsoft\Windows Photo Viewer\Capabilities\FileAssociations', value: '.tif', type: REG_SZ, data: 'PhotoViewer.FileAssoc.Tiff', option: "configure-lpv"}
  - !registryValue: {path: 'HKLM\SOFTWARE\Microsoft\Windows Photo Viewer\Capabilities\FileAssociations', value: '.tiff', type: REG_SZ, data: 'PhotoViewer.FileAssoc.Tiff', option: "configure-lpv"}
  - !registryValue: {path: 'HKCU\Software\Classes\.jpg', value: '', type: REG_SZ, data: 'PhotoViewer.FileAssoc.Tiff', option: "configure-lpv"}
  - !registryValue: {path: 'HKCU\Software\Classes\.jpeg', value: '', type: REG_SZ, data: 'PhotoViewer.FileAssoc.Tiff', option: "configure-lpv"}
  - !registryValue: {path: 'HKCU\Software\Classes\.gif', value: '', type: REG_SZ, data: 'PhotoViewer.FileAssoc.Tiff', option: "configure-lpv"}
  - !registryValue: {path: 'HKCU\Software\Classes\.png', value: '', type: REG_SZ, data: 'PhotoViewer.FileAssoc.Tiff', option: "configure-lpv"}
  - !registryValue: {path: 'HKCU\Software\Classes\.bmp', value: '', type: REG_SZ, data: 'PhotoViewer.FileAssoc.Tiff', option: "configure-lpv"}
  - !registryValue: {path: 'HKCU\Software\Classes\.tiff', value: '', type: REG_SZ, data: 'PhotoViewer.FileAssoc.Tiff', option: "configure-lpv"}
  - !registryValue: {path: 'HKCU\Software\Classes\.ico', value: '', type: REG_SZ, data: 'PhotoViewer.FileAssoc.Tiff', option: "configure-lpv"}
